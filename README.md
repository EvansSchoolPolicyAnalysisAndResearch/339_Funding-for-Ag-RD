# 339 Funding for Agricultural R&D
## Information
The files contained within this repository were used in the data collection portion of [EPAR Technical Report 339](https://evans.uw.edu/policy-impact/epar/research/funding-agricultural-research-and-development-public-goods). These data were later used to create visualizations available on the [EPAR website](https://evans.uw.edu/policy-impact/epar/changes-public-sector-agriculture-rd-investment-sub-saharan-africa).
## Instructions
ASTI_FAOSTAT_Final_1.19.19.do: This file takes crop specific FAOSTAT indicators, aggregates them to ASTI categories, merges them with ASTI data on Agricultural FTEs by crop, and outputs a file that one can directly import into Tableau to create or update visualizations.  

To use the .do file, you must first put the raw data files somewhere the .do file can find them.  You will need to download files from the ASTI database as well as the FAOSTAT database.  Download the full database from FAOSTAT (go to http://www.fao.org/faostat/en/#home and use the bulk download function), place it in a folder FAOSTAT Complete Dataset in the location that you can enter in the “ENTER FILEPATH HERE” section of the global named “import”.  Follow the directions in section 2.0 of the file for the specifics of the ASTI data to download.  Place these data into a folder entitled New ASTI Data in the location that you can enter in the “ENTER FILEPATH HERE” section of the global named “input”.  Finally, download the file “EPAR_UW_339_GPG Correlates_Crop-Level Data Decisions FAOSTAT.xlsx" and the " EPAR_UW_339_FAOSTAT File Names.xlsx" file and replace the “ENTER FILEPATH HERE” in the global named “GPGcategorizations” with their location.

Once you have your new data files, all you need to do is set five global macros at the top of the file.  They are right after the outline and before the “0. Creating Globals” section.  The “astiyear” macro denotes the year of ASTI data that you want to query.  Since the program takes a long time to run (and can throw out an occasional random error), it currently only supports working with one year of ASTI data at a time.  The “faostatyear” macro denotes the most recent year of FAOSTAT data that you want to query.  You can query multiple consecutive FAOSTAT years by setting the next macro “numpreviousyears” to a value greater than one.  For example, if it is three, and “faostatyear” is 2013, the program will look at 2011, 2012 and 2013.  The two remaining global macros relate to the place where the program will create its files.  The program will create a folder with the name you enter in the global “directoryname” in the folder designated by the global macro “filedirectory.”

If you want to look at a nonconsecutive set of FAOSTAT years, you can manually change the global macros “otheryearsfaostat” and “allyearsfaostat” in section 0.4.  The global “allyearsfaostat” should be the years you want to look at, and the global “otheryearsfaostat” should be all other years from 1900 to 2100.  You will also need to set “numpreviousyears” to the number of members of “allyearsfaostat”.

Once you run the program, the output file will show up in the Outputs folder in the directory that you designated.  The xls file should be ready to be imported into Tableau and can be used to quickly update current visualizations.
